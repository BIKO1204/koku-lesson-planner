{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/yukia/Downloads/koku-lesson-planner/lib/drive.ts"],"sourcesContent":["import { getSession } from \"next-auth/react\";\r\n\r\nexport async function uploadToDrive(\r\n  blob: Blob,\r\n  filename: string,\r\n  mimeType: string,\r\n  folderId?: string\r\n): Promise<string> {\r\n  const session = await getSession();\r\n  // 型拡張がまだなら any で回避\r\n  const accessToken = (session as any)?.accessToken as string | undefined;\r\n\r\n  if (!accessToken) {\r\n    throw new Error(\"Drive 用のアクセストークンが取得できませんでした\");\r\n  }\r\n\r\n  const metadata = {\r\n    name: filename,\r\n    mimeType,\r\n    ...(folderId ? { parents: [folderId] } : {}),\r\n  };\r\n\r\n  const form = new FormData();\r\n  form.append(\r\n    \"metadata\",\r\n    new Blob([JSON.stringify(metadata)], { type: \"application/json\" })\r\n  );\r\n  form.append(\"file\", blob);\r\n\r\n  const res = await fetch(\r\n    \"https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id\",\r\n    {\r\n      method: \"POST\",\r\n      headers: {\r\n        Authorization: `Bearer ${accessToken}`,\r\n      },\r\n      body: form,\r\n    }\r\n  );\r\n\r\n  if (!res.ok) {\r\n    const errorText = await res.text();\r\n    console.error(\"Driveアップロード失敗:\", errorText);\r\n    throw new Error(\"Drive へのファイルアップロードに失敗しました\");\r\n  }\r\n\r\n  const { id } = await res.json();\r\n  return id;\r\n}\r\n"],"names":[],"mappings":";;;AAAA;;AAEO,eAAe,cACpB,IAAU,EACV,QAAgB,EAChB,QAAgB,EAChB,QAAiB;IAEjB,MAAM,UAAU,MAAM,CAAA,GAAA,8IAAA,CAAA,aAAU,AAAD;IAC/B,mBAAmB;IACnB,MAAM,cAAe,SAAiB;IAEtC,IAAI,CAAC,aAAa;QAChB,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,WAAW;QACf,MAAM;QACN;QACA,GAAI,WAAW;YAAE,SAAS;gBAAC;aAAS;QAAC,IAAI,CAAC,CAAC;IAC7C;IAEA,MAAM,OAAO,IAAI;IACjB,KAAK,MAAM,CACT,YACA,IAAI,KAAK;QAAC,KAAK,SAAS,CAAC;KAAU,EAAE;QAAE,MAAM;IAAmB;IAElE,KAAK,MAAM,CAAC,QAAQ;IAEpB,MAAM,MAAM,MAAM,MAChB,mFACA;QACE,QAAQ;QACR,SAAS;YACP,eAAe,CAAC,OAAO,EAAE,aAAa;QACxC;QACA,MAAM;IACR;IAGF,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,YAAY,MAAM,IAAI,IAAI;QAChC,QAAQ,KAAK,CAAC,kBAAkB;QAChC,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM,IAAI,IAAI;IAC7B,OAAO;AACT","debugId":null}}]
}